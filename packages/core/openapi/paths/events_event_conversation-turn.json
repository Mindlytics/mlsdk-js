{
  "post": {
    "tags": [
      "Events"
    ],
    "summary": "Conversation turn",
    "description": "A turn in a conversation.",
    "parameters": [
      {
        "name": "Authorization",
        "in": "header",
        "required": true,
        "schema": {
          "type": "string",
          "title": "Authorization",
          "description": "The API key for the organization."
        }
      },
      {
        "name": "x-app-id",
        "in": "header",
        "required": true,
        "schema": {
          "type": "string",
          "title": "App ID",
          "description": "The app ID"
        }
      }
    ],
    "requestBody": {
      "required": true,
      "content": {
        "application/json": {
          "schema": {
            "type": "object",
            "properties": {
              "session_id": {
                "type": "string",
                "description": "A unique session ID generated by caller"
              },
              "timestamp": {
                "type": "string",
                "description": "The timestamp of the event, defaults to \"now\" if not specified."
              },
              "type": {
                "type": "string",
                "enum": [
                  "track"
                ],
                "description": "The event that tracks an arbitray event"
              },
              "event": {
                "type": "string",
                "enum": [
                  "Conversation Turn"
                ],
                "description": "The event that represents a turn in a conversation"
              },
              "conversation_id": {
                "type": "string",
                "description": "The ID of the conversation"
              },
              "properties": {
                "type": "object",
                "properties": {
                  "user": {
                    "type": "string"
                  },
                  "assistant": {
                    "type": "string"
                  }
                },
                "required": [
                  "user",
                  "assistant"
                ],
                "additionalProperties": {
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "boolean"
                    }
                  ]
                },
                "description": "Properties of a tun event"
              },
              "turn_analysis": {
                "type": "object",
                "properties": {
                  "user": {
                    "type": "object",
                    "properties": {
                      "actions": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "action": {
                              "type": "string",
                              "enum": [
                                "Intent Informed",
                                "Intent Rejected",
                                "Intent Accepted",
                                "Attribute Informed",
                                "Attribute Demanded",
                                "Attribute Accepted",
                                "Attribute Denied",
                                "Attribute Selected",
                                "Attribute AlternateRequested",
                                "Thank the Assistant",
                                "End the Conversation"
                              ],
                              "description": "The action the user is taking in this turn. One of the predefined UserActionNames."
                            },
                            "slot": {
                              "type": "string",
                              "description": "The name of the slot being referred to in the action."
                            },
                            "values": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              },
                              "description": "The values of the slot being referred to in the action."
                            }
                          },
                          "required": [
                            "action"
                          ]
                        },
                        "description": "The actions that the user is taking in this turn."
                      },
                      "state": {
                        "type": "object",
                        "properties": {
                          "active_intent": {
                            "type": "string",
                            "description": "The intent that the user is currently trying to accomplish."
                          },
                          "requested_slots": {
                            "type": "array",
                            "items": {
                              "type": "string"
                            },
                            "description": "The slots (or information) that the user has requested from the system in this turn."
                          },
                          "slot_values": {
                            "type": "object",
                            "additionalProperties": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              }
                            },
                            "description": "The values of the slots that the user has provided so far in the dialog.  Keys are slot names, values are arrays of slot values."
                          }
                        },
                        "required": [
                          "active_intent",
                          "requested_slots",
                          "slot_values"
                        ],
                        "description": "The state of the dialog at this point."
                      }
                    },
                    "required": [
                      "actions",
                      "state"
                    ],
                    "description": "The user turn in the dialog."
                  },
                  "system": {
                    "type": "object",
                    "properties": {
                      "actions": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "action": {
                              "type": "string",
                              "enum": [
                                "Attribute Advised",
                                "Attribute Requested",
                                "Attribute Confirmed",
                                "Attribute Offered",
                                "Status Notified Success",
                                "Status Notified Failure",
                                "Count Informed",
                                "Intent Offered",
                                "More Prompted",
                                "End the Conversation"
                              ],
                              "description": "The action the system is taking in this turn. One of the predefined SystemActionNames."
                            },
                            "slot": {
                              "type": "string",
                              "description": "The name of the slot being referred to in the action."
                            },
                            "values": {
                              "type": "array",
                              "items": {
                                "type": "string"
                              },
                              "description": "The values of the slot being referred to in the action."
                            }
                          },
                          "required": [
                            "action"
                          ]
                        },
                        "description": "The actions that the system is taking in this turn."
                      }
                    },
                    "required": [
                      "actions"
                    ],
                    "description": "The system turn in the dialog."
                  }
                },
                "required": [
                  "user",
                  "system"
                ]
              },
              "intent_analysis": {
                "type": "object",
                "properties": {
                  "summary": {
                    "type": "string",
                    "description": "A summary of the user's intent."
                  },
                  "sentiment": {
                    "type": "string",
                    "enum": [
                      "positive",
                      "negative",
                      "neutral"
                    ],
                    "description": "The sentiment associated with the intent."
                  },
                  "intent_fulfilled": {
                    "type": "string",
                    "enum": [
                      "yes",
                      "no"
                    ],
                    "description": "Whether the intent was successfully fulfilled."
                  },
                  "cost": {
                    "type": "number"
                  }
                },
                "required": [
                  "summary",
                  "sentiment",
                  "intent_fulfilled",
                  "cost"
                ]
              }
            },
            "required": [
              "session_id",
              "type",
              "event",
              "conversation_id",
              "properties"
            ]
          }
        }
      }
    },
    "responses": {
      "200": {
        "description": "Success",
        "content": {
          "application/json": {
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "type": {
                    "type": "string",
                    "enum": [
                      "start_session",
                      "end_session",
                      "identify",
                      "alias",
                      "track"
                    ],
                    "title": "Event Type",
                    "description": "The type of event being sent."
                  }
                },
                "required": [
                  "type"
                ],
                "additionalProperties": {
                  "anyOf": [
                    {
                      "type": "string"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "boolean"
                    }
                  ]
                },
                "title": "Other properties",
                "description": "Propties that depend on the event type."
              },
              "title": "Events",
              "description": "The events that were generated by the Mindlytics service as a result of this event."
            }
          }
        }
      }
    }
  }
}